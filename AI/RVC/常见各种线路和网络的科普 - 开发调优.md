---
title: "常见各种线路和网络的科普 - 开发调优"
source: "https://linux.do/t/topic/1235548"
author:
  - "[[LINUX DO]]"
published: 2025-12-06
created: 2025-12-06
description: "使用 @discobot 开始 高级教程 回复本消息可以了解你还可以做什么。"
tags:
  - "clippings"
---
[跳转到您离开的地方 (post 6)](https://linux.do/t/topic/1235548/6) [跳转到最后一条回复](https://linux.do/t/topic/1235548/128) [跳转到顶部](https://linux.do/t/topic/1235548/1)

## 由 STALK 发布于 11月 29 日

[ICMP不可达喵](https://linux.do/u/stalk) [STALK](https://linux.do/u/stalk) 指导顾问

[7 天](https://linux.do/t/topic/1235548?u=dumpsite_wanderer "发布日期")

MJJ你们好，大家在购买机器的时候时关注的无非是三个问题：ip质量，机器性能和网络线路。 [ip质量](https://meowvps.com/blog/ipcheck/) 已经详细系统的介绍过，今天就来介绍最重要的网络线路的板块。

本文按照以下顺序展开：

网络线路定义->ASN->国内线路->专线>国际互联->常用工具

### 1.网络线路的定义与实际影响

#### 网络线路是什么？

简单来说,网络线路就是你的数据从本地电脑到远程服务器所经过的"道路"。

你的数据包就会顺着网络线路一路来到你的远程服务器，然后经过服务器处理再发回给你。

可以粗略的看为

```rust
你的电脑->国内线路->国际线路->你的远程服务器->访问各大网站

你的电脑<-国内线路<-国际线路<-你的远程服务器<-----|
```

数据包在这些节点流动的快慢，就可以理解为网络质量。

数据包在互联网上传输时,需要经过多个网络节点(路由器)的转发,每一跳都可能影响最终的网络质量。线路质量主要体现在以下几个方面：

- **延迟(Ping)**: 数据往返所需的时间
- **带宽**: 单位时间内能传输的数据量
- **丢包率**: 数据包丢失的比例
- **稳定性**: 网络质量的波动程度

这几个指标可以大致的反馈出一个网络链路的质量。

> 值得注意的是：很多小白喜欢通过延时来直接判断一个网络快慢，实际上是相当不准的。延时影响响应速度,带宽影响吞吐量，有的线路延时低但带宽低，可能只有10Mbps，看个视频就卡住了；而有的线路更逆天，甚至只专门针对ICMP优化，ping走优质链路而其他网络活动全部走劣质链路。

#### 线路对使用体验的影响

- 延时主要影响打开网页的速度，也就是我们平时说的秒开网页不转圈。
- 带宽主要影响传输数据的速度，也就是我们说的上下行速度，比如speedtest/youtube的connection speed指标。
- 前面两者都是建立在不丢包的前提下，当丢包率比较高时，打开网页就会转圈/测试速度也会很低，很多时候还会引起断流。
- 稳定性一般就是指晚高峰速率，晚高峰大家都在看视频刷手机，网络链路变得拥挤，大家的速度就会下降，有的网络线路白天闲时随便跑1000Mbps，而晚高峰只有个位数的速度，而有的线路可以做到全天24小时1000Mbps，这就是稳定性的区别。

### 2.AS(自治系统)与基础协议介绍

> 计算机网络的基础知识，已经尽量简化，隐去无关技术细节

#### AS是什么，AS有什么作用？

互联网是由不同网络组成的网络，自治系统是组成互联网的大型网络。更具体地说，自治系统（AS）是具有统一路由策略的巨型网络或网络群组。连接到互联网的每台计算机或设备都连接到一个 AS。每个大型网络运营商、互联网服务提供商(ISP)都有自己的ASN。

**通俗理解** ：AS就像是互联网世界里的"邮政系统"，每个AS相当于一个大型邮局，负责管理一片IP地址区域。

> 每个AS会分配的唯一标识符，这个标识符是个数字，比如你分配为AS7018，它分配为AS4837，我们就会用AS编号来称呼某个AS。

举个例子：

- **AS4134（比如中国电信）** ：负责管理A段IP地址（比如1.0.0.0 - 1.255.255.255）
- **AS7018（比如美国的AT&T）** ：负责管理B段IP地址（比如8.0.0.0 - 8.255.255.255）

**数据传输的过程** ：

1. 正常情况下，A段的用户访问A段的服务器，数据直接在AS4134内部传递，就像同城寄信一样快速。
2. 当A段的用户想访问B段的服务器时（比如你在国内访问美国网站）：
	- 你的数据包首先到达AS4134（电信）
	- AS4134发现目标地址不在自己管辖范围内
	- AS4134查找信息，找到通往AS7018的路径
	- 数据包经过AS4134 → 可能经过中间的其他ASN… → 最终到达AS7018
	- AS7018把数据包送到B段的目标服务器

就像寄国际包裹：从你手里 → 本地邮局 → 省级邮局 → 国际转运中心 → 目的地国家转运中心 → 目的地邮局 → 收件人。

不同的AS负责管理和宣告一段IP地址空间，并负责这些IP地址的路由决策。AS内部如何通信是其自主决定的（这就是"自治"的含义），外部AS不需要知道内部细节。

BGP（边界网关协议）是AS之间交换路由信息的协议。通过BGP，每个AS会告诉其他AS：“我这里有哪些IP段，如果你要访问这些IP，可以把数据包发给我。”

这也是为什么MJJ说"查一下BGP就知道路由了"——通过BGP数据库可以看到：

- 某个IP属于哪个AS
- 这个AS和哪些AS有连接
- 数据包可能经过的路径

[![BGP](attachments/d81ff20428daa5b7bfec4f01ab283a1b58758eae_2_357x500.png)

这个是BGPTOOLS的查询结果，可以查到ip对应的AS和连接到的其他ASN，图中就是DMIT与其他AS的连接情况，你可以看到DMIT被分配了AS编号为906，DMIT (AS906) 有三个直接上游：

- **AS137409 (GSL Networks)** - 通过它可以到达更多Tier1比如NTT/Zayo
- **AS3257 (GTT)** - 直接与Tier1连接
- **AS1299 (Arelion)** - 直接与Tier1连接

然后通过这三个上游，可以进一步到达其他Tier1运营商，如：

- AS12956 (Telxius)
- AS7018 (AT&T)
- AS5511 (Orange)等等

**什么是Tier 1？**

Tier1是指在全球互联网层级结构中处于顶层的网络运营商，其核心特征是：

- **无需购买传输服务（Transit-free）** ：Tier1运营商拥有覆盖全球的骨干网络，可以通过免费的对等互联（Settlement-free peering）到达互联网上的任何其他网络，而无需向任何其他网络支付传输费用。
- **全球可达性（Global reach）** ：必须能够仅通过对等互联（peering）关系就能到达互联网上的所有目的地，不依赖任何上游提供商。
- **对等互联网络（Peering with other Tier1s）** ：与其他所有Tier1运营商建立免费的对等互联关系。

> 实际上Tier1之间的关系也很复杂，历史上曾出现过某些Tier1互不peering的情况，比如Cogent和Telia曾经长期不互联。

你可以看到上面图的蓝色部分就是Tier1,。通俗的讲：Tier1就是全球互联网层级结构中处于顶层的网络运营商，是AS巨头，发挥关键骨干作用。AS有大有小，你也可以拥有自己的AS，但是你不是巨头，你只能向Tier1或者其下游购买数据传输服务来接入他们的网络，比如DMIT，GSL都是这样干的。

从成本来看，这很实惠

```rust
Tier1 ←→ Tier1：免费互换流量
Tier1 ←→ Tier2：Tier2付费
Tier2 ←→ Tier3：Tier3付费
Tier3 ←→ 终端用户：用户付费
```

这里的例子就是GSL向Zayo/Cogent/NTT付费接入Tier1，而DMIT又向GSL付费接入GSL间接接入Zayo/Cogent/NTT，因为直接接入Tier可能网络状况更好(途径AS少，路由跳转少)但是价格高昂，向Tier2付费就显得实惠的多。

看BGP图可以大致的猜出一个ip的网络环境，接入了同一个AS的ip之间传输速度一般很快，而且不会绕路。

#### 常见网络协议：：TCP/UDP/ICMP

我们的网络数据包会根据使用场景封装到不同的传输协议中来应对不同状况，AS也可以根据协议不同给予不同的流量策略。下面简单介绍最常用的三个协议(就不按模型分层了，不利于小白理解)

**TCP（传输控制协议，Transmission Control Protocol）**

> TCP就像"顺丰快递"——保证包裹一定送到，而且按顺序送达

可靠传输，保证数据完整且有序送达，丢包会自动重传，但是因为要保证可靠性，所以时间较慢，延时较高。常见应用场景就是网页浏览(HTTP/HTTPS)，，看视频，下载文件。

场景：只要数据不能出错、不能丢失，就用TCP

**UDP（用户数据报协议，User Datagram Protocol）**

> UDP就像"直接扔快递"——不管对方收没收到，扔过去就完事

不可靠传输，且不保证数据送达，但是延时低，速度快。常见应用就是直播/实时视频聊天/打游戏等。

场景：实时性比可靠性更重要，或数据量小可以接受重发

**ICMP（互联网控制消息协议，Internet Control Message Protocol）**

> ICMP就像"邮政系统的通知单"——不传递实际包裹，只传递状态信息

主要用于网络诊断和错误报告，不传输用户数据信息。常见场景就是ping命令和Traceroute等，都是基于ICMP协议的。

理解这三个协议对整个网络的运行有巨大帮助，比如ping不通可能是因为对方屏蔽了ICMP，不意味着TCP/UDP不可达;TCP快不等于UDP快，因为有些服务商对UDP有限速(大量的UDP流量看起来像是在网络攻击)。

> 哇哦，如果我开个IDC针对ICMP优化，ping可以达到30ms而TCP则绕路200ms，这样是不是可以大卖呢？

测试结果：

- 小白用户：哇！Ping才30ms，真快！
- （购买） 使用后：怎么这么卡？可能是我网络问题吧…（自我怀疑）
- 商家：
	[![image](attachments/0bdb72cebc3bbfaa332079bc238138e87f7007c6.jpeg)](https://linux.do/uploads/default/original/4X/0/b/d/0bdb72cebc3bbfaa332079bc238138e87f7007c6.jpeg "image")
	咳咳咳~

### 3.中国三大运营商线路

> 本文目标清晰，主打小白向，所以删除CIXF，Tier1Transit，POP点互联等知识

在国内，最大的三个网络运营商电信，联通和移动，各自都有自己的局域网，也有自己的ASN，我们的流量就是走的这些ASN来和服务器进行交流沟通。流量的轨迹一般是 `你家->省网->跨境->国际出口` ，网络线路的体验也就和流经这些段的速度相关。

下面就要介绍一个重要概念： **QOS（服务质量)**

QoS本意是"服务质量保障"，包括优先级提升、带宽保证等 **正向** 措施。限速、降级只是QoS的一种应用场景（通常是对低优先级流量）。比如说平时我是G口网，但是晚高峰用的人多了，总带宽就这么大，运营商就对部分用户进行QOS，让大家都变慢，让我的G口网变成了100M网，这样虽然大家卡了，但不至于说有人没有网络。

被qos就是我们需要挑选线路的重要原因，因为无论哪个运营商，晚高峰期间都是优先确保优化网的网络，而去qos普通网的用户，所以有些线路平日里还行一到晚高峰就炸。

> 很多时候，我们说的被q不是指qos了，就是指被限速了，大家已经口头习俗的用被q来代替被限速。

#### 电信线路（163/CN2 GT/CN2 GIA）

- AS4134：国内骨干网，俗称4134或163骨干网，ip常以202.97开头. 定位于承载普通质量的互联网业务, 基建早, 带宽大, 便宜，多次扩容后拥挤情况有改善，绝大部分普通家宽的出境路线。
- AS4809：国内精品网，俗称CN2，ip常以59.43开头. CN2 相比较 163 网络, 带宽小, 稳定高速。
- AS23764：境外网，俗称CTGNet，用于面向企业客户提供定制化的国际互联网专线接入服务。

> CN2实际上分为CN2GT和CN2GIA两种。CN2GT又称半程CN2，Global Transit，因为其国内走163骨干网，跨境和163挤在一个段里(那我要你有何用)，国外和CN2一样；CN2GIA是全程CN2，跨境段不用和163挤在一起，拥有自己的带宽，国内国外都走CN2网络。

亚太还有个比较流行的163pp，俗称高q163，其实就是拥有跨境段高qos保障的163，相当于单独购买了带宽的163骨干网，大部分163跨境都是共享的，导致晚高峰互相抢带宽，卡的半死，高q163贵的夸张…

```rust
#可以看到电信去程走的是CN2骨干网
# 时间：2024-07-07 23:16:36
1   192.168.50.1    *                         RFC1918
                                            0.51 ms / 0.88 ms / 1.07 ms
2   116.233.80.1    AS4812   [CHINANET-SH]    中国 上海 上海  chinatelecom.cn
                                            6.68 ms / 5.92 ms / 6.34 ms
3   124.75.232.117  AS4812   [CHINANET-SH]    中国 上海 上海  chinatelecom.cn
                                            2.60 ms / 3.00 ms / 2.95 ms
4   61.152.54.177   AS4812   [CHINANET-SH]    中国 上海   chinatelecom.cn  电信
                                            3.18 ms / * ms / * ms
5   61.152.24.118   AS4812   [CHINANET-SH]    中国 上海   chinatelecom.cn  电信
                                            4.93 ms / 105.15 ms / * ms
6   59.43.80.142    *        [CN2-BackBone]   中国 上海   chinatelecom.cn  电信
                                            11.95 ms / 5.59 ms / 8.94 ms
7   59.43.22.6      *        [CN2-BackBone]   中国 上海 C-I  chinatelecom.cn  电信
                                            5.67 ms / * ms / * ms
8   59.43.39.154    *        [CN2-BackBone]   中国 上海   chinatelecom.cn  电信
                                            6.04 ms / 106.66 ms / * ms
9   59.43.182.181   *        [CN2-BackBone]   美国 加利福尼亚 圣何塞  chinatelecom.cn  电信
                                            129.89 ms / 127.50 ms / 127.40 ms
10  218.30.49.182   AS4134   [CHINANET-US]    美国 加利福尼亚 圣何塞  www.chinatelecom.com.cn  电信
                                            140.20 ms / 139.90 ms / 139.33 ms
11  91.200.241.87   *                         美国 加利福尼亚 圣何塞
  cs03.q51.sjc.xtom.us                      158.29 ms / 275.86 ms / * ms
12  xxx.xxx.xxx.98    AS6233                    美国 加利福尼亚州 圣何塞  xtom.com
  xxx.xxx.xxx.vps.hosting                        128.21 ms / 127.87 ms / 128.31 ms

#可以看到回程走的也是CN2
# 时间：2024-07-07 23:16:36
1   45.139.193.1    AS8888                    美国 加利福尼亚 圣何塞  xtom.com
                                            36.96 ms / 4.64 ms / 40.33 ms
2   91.200.241.86   *                         美国 加利福尼亚 圣何塞
                                            0.39 ms / 0.26 ms / 0.40 ms
3   218.30.49.181   AS4134   [CHINANET-US]    美国 加利福尼亚 圣何塞  www.chinatelecom.com.cn  电信
                                            0.89 ms / 0.99 ms / 0.64 ms
4   59.43.182.182   *        [CN2-BackBone]   中国 上海   chinatelecom.cn  电信
                                            123.80 ms / 122.43 ms / * ms
5   *
6   59.43.22.5      *        [CN2-BackBone]   中国 上海  C-I chinatelecom.cn  电信
                                            127.02 ms / 124.53 ms / 130.04 ms
7   59.43.80.141    *        [CN2-BackBone]   中国 上海   chinatelecom.cn  电信
                                            177.49 ms / 175.56 ms / * ms
8   61.152.25.197   AS4812   [CHINANET-SH]    中国 上海   chinatelecom.cn  电信
                                            128.97 ms / 125.90 ms / 131.26 ms
9   61.172.67.150   AS4812                    中国 上海  青浦 chinatelecom.cn  电信
                                            137.60 ms / 125.11 ms / 126.16 ms
10  58.37.40.1      AS4812                    中国 上海   chinatelecom.cn  电信
  1.40.37.58.broad.xw.sh.dynamic.163data.com.cn   228.09 ms / * ms / * ms
这就是电信CN2GIA双程，属于电信极致网络。
```

#### 联通线路（4837/9929）

- AS4837：国内骨干网，俗称4837或联通169网络，IP以219.158开头，相当于电信中的163骨干网，大部分联通家宽的线路 。
- AS9929：国内老骨干网，俗称A网或者9929或者CUII，定位类似于电信中的CN2，实际上这玩意和优化度很高的CN2没得比，这只是使用人数很少的普通网络，承载力和质量远远不如CN2，而且9929的口子普遍不大。
- AS10099：境外网，俗称联通国际CUG，提供至大陆方向的差异化接入。

线路组合有以下几种：

- 内地 AS4837 + 境外 AS4837：最普通、最常见的联通 169 网络
- 内地 AS4837 + 境外 AS10099：应该算是高端线路。
- 内地 AS9929 + 境外 AS4837：很少见的路由。
- 内地 AS9929 + 境外 AS10099：联通高端线路。
```rust
# 去程国内省内先走了一段普通网4837，随后接入9929优化网，到了境外走优化线路CUG，去程优秀。
# 时间：2024-07-07 23:16:36
1   192.168.1.1     *                         RFC1918
                                            0.63 ms / 0.45 ms / 0.49 ms
2   115.49.100.1    AS4837   [UNICOM-HA]      中国 河南 南阳市 新野 chinaunicom.cn
  hn.kd.ny.adsl                             3.66 ms / 18.18 ms / 2.78 ms
3   219.154.128.197 AS4837   [UNICOM-CN]      中国 河南 南阳  chinaunicom.cn
  hn.kd.jz.adsl                             4.22 ms / 18.30 ms / 7.32 ms
4   61.168.28.165   AS4837   [UNICOM-HA]      中国 河南 郑州市  chinaunicom.cn  联通
  pc165.zz.ha.cn                            * ms / 37.55 ms / 37.46 ms
5   219.158.121.129 AS4837   [CU169-BACKBONE] 中国    chinaunicom.cn  联通
                                            24.84 ms / 24.58 ms / 24.73 ms
6   219.158.119.246 AS4837   [CU169-BACKBONE] 中国 上海   chinaunicom.cn  联通
                                            27.39 ms / 24.56 ms / 29.73 ms
7   219.158.32.6    AS4837   [CU169-BACKBONE] 中国 上海   chinaunicom.cn  联通
                                            26.21 ms / 26.03 ms / 26.05 ms
8   218.105.2.209   AS9929   [CNC-BACKBONE]   中国 上海   chinaunicom.cn  联通 CUII
                                            30.64 ms / 30.40 ms / 30.34 ms
9   218.105.2.202   AS9929   [CNC-BACKBONE]   中国 上海   chinaunicom.cn  联通 CUII
                                            27.18 ms / 28.48 ms / 26.97 ms
10  203.160.75.217  AS10099  [CUG-BACKBONE]   美国 加利福尼亚 洛杉矶  chinaunicomglobal.com  联通
                                            158.17 ms / 158.31 ms / 157.90 ms
11  162.219.85.182  AS10099  [CUG-BACKBONE]   美国 加利福尼亚 圣何塞  chinaunicomglobal.com  联通
                                            162.02 ms / 162.05 ms / 162.02 ms
12  91.200.241.87   *                         美国 加利福尼亚 圣何塞
                                            166.27 ms / 168.89 ms / 169.22 ms
13  xxx.xxx.xxx.98    AS6233                    美国 加利福尼亚州 圣何塞  xtom.com
                                            161.98 ms / 162.04 ms / 162.12 ms
# 回程也是先CUG入境，中间路线看不到了，大概率对称9929。
# 时间：2024-07-07 23:16:36
1   45.139.193.1    AS8888                    美国 加利福尼亚 圣何塞  xtom.com
                                            5.57 ms / 3.01 ms / 23.26 ms
2   91.200.241.88   *                         美国 加利福尼亚 圣何塞
                                            0.33 ms / 0.38 ms / 0.37 ms
3   162.219.85.181  AS10099  [CUG-BACKBONE]   美国 加利福尼亚 圣何塞  chinaunicomglobal.com  联通
                                            0.96 ms / 0.97 ms / 0.97 ms
4   162.219.85.13   AS10099  [CUG-BACKBONE]   中国 上海   chinaunicomglobal.com  联通
                                            131.61 ms / 128.86 ms / 128.89 ms
5   210.14.186.137  *        [APNIC-AP]       中国 上海
                                            132.68 ms / 132.58 ms / 132.55 ms
6   *
7   *
8   210.78.8.146    *        [CNC-BACKBONE]   中国 河南 郑州  chinaunicom.cn  联通 CUII
                                            157.51 ms / 156.68 ms / 156.76 ms
9   219.158.45.57   AS4837   [CU169-BACKBONE] 中国 河南 新乡  chinaunicom.cn  联通
                                            152.74 ms / 153.83 ms / 151.12 ms
10  219.158.112.97  AS4837   [CU169-BACKBONE] 中国 河南 郑州  chinaunicom.cn  联通
                                            156.50 ms / 158.49 ms / 158.17 ms
11  61.168.38.218   AS4837   [UNICOM-HA]      中国 河南 郑州  chinaunicom.cn
  pc218.zz.ha.cn                            258.82 ms / * ms / * ms
12  61.168.238.14   AS4837   [UNICOM-HA]      中国 河南 南阳市  chinaunicom.cn  联通
                                            159.28 ms / 162.72 ms / 159.16 ms
13  123.4.44.63     AS4837   [UNICOM-HA]      中国 河南 南阳  chinaunicom.cn
                                            160.90 ms / 161.27 ms / 161.18 ms
这就是联通的双程极致线路。
```

#### 移动线路（CMI/CMIN2）

- AS9808：国内网，俗称CMNET，对标电信普通网。
- AS58453：境外网，俗称CMI，最常见的网段，负载均衡做的极其差劲，而且由于带宽被灌满，而且万物走香港出口，骨干疯狂丢包。
- AS58807：境外网，俗称CMI N2，移动精品网。
- AS3356：Tier1，俗称lumen，实际上，lumen并不是移动管辖的网络，但是lumen-cmi的传输方式让移动用户用起来相当舒服，lumen也成了实际上更受欢迎的移动快乐机器，大家看到lumen都知道移动基本快乐，所以把lumen并入移动线路。 ~~个人分类纯属娱乐，这种传输方式哪天就被移动干爆~~

> 你可以发现，移动的国内网都是一样的，只有跨境段和境外段才区分CMI还是CMIN2，也就是说，移动用户哪怕用的是CMIN2，国内段也照样和CMI的用户一起挤，这也导致移动的晚高峰qos格外严重

```rust
# 时间：2024-07-07 23:16:36
1   192.168.1.1     *                         RFC1918
                                            1.52 ms / 1.33 ms / 1.39 ms
2   *
3   120.204.37.49   AS24400  [APNIC-AP]       中国 上海 上海  chinamobile.com
                                            4.49 ms / * ms / * ms
4   *
5   111.24.4.89     AS9808   [CMNET]          中国 上海   chinamobileltd.com  移动
                                            5.10 ms / 4.88 ms / 4.97 ms
6   221.183.179.22  AS9808   [CMNET]          中国 上海   chinamobileltd.com
                                            5.43 ms / 5.18 ms / 5.28 ms
7   221.183.87.218  AS9808   [CMNET]          中国 上海   chinamobileltd.com  移动
                                            6.06 ms / 5.46 ms / 5.40 ms
8   221.183.92.110  AS9808   [CMNET]          中国 上海   chinamobileltd.com  移动
                                            5.96 ms / 5.44 ms / 16.83 ms
9   223.120.160.6   AS58807  [CMIN2-NET]      美国 加利福尼亚 圣何塞  cmi.chinamobile.com  移动
                                            128.12 ms / 128.48 ms / 128.88 ms
10  223.120.196.38  AS58807  [CMIN2-NET]      美国 加利福尼亚 圣何塞  cmi.chinamobile.com  移动
                                            128.24 ms / 128.24 ms / 128.10 ms
11  223.120.200.25  AS58807  [CMIN2-NET]      美国 加利福尼亚 洛杉矶  cmi.chinamobile.com  移动
                                            135.52 ms / 128.98 ms / 134.23 ms
12  91.200.241.89   *                         美国 加利福尼亚 圣何塞
                                            138.98 ms / 135.83 ms / 133.68 ms
13  xxx.xxx.xxx.98    AS6233                    美国 加利福尼亚州 圣何塞  xtom.com
  xxx.xxx.xxx.vps.hosting                        127.71 ms / 127.82 ms / 127.59 ms

# 时间：2024-07-07 23:16:36
1   45.139.193.1    AS8888                    美国 加利福尼亚 圣何塞  xtom.com
                                            12.53 ms / 15.81 ms / 2.42 ms
2   91.200.241.86   *                         美国 加利福尼亚 圣何塞
                                            0.35 ms / 0.36 ms / 0.30 ms
3   223.120.200.24  AS58807  [CMIN2-NET]      美国 加利福尼亚 洛杉矶  cmi.chinamobile.com  移动
                                            0.47 ms / 0.58 ms / 0.60 ms
4   223.120.196.37  AS58807  [CMIN2-NET]      美国 加利福尼亚 圣何塞  cmi.chinamobile.com  移动
                                            123.57 ms / 123.50 ms / 122.53 ms
5   223.120.160.5   AS58807  [CMIN2-NET]      中国 上海   cmi.chinamobile.com
                                            122.86 ms / 122.45 ms / 122.47 ms
6   221.183.92.113  AS9808   [CMNET]          中国 上海   chinamobileltd.com  移动
                                            123.61 ms / 136.29 ms / 123.40 ms
7   221.183.87.245  AS9808   [CMNET]          中国 上海   chinamobileltd.com  移动
                                            123.66 ms / 123.42 ms / 123.52 ms
8   221.183.87.226  AS9808   [CMNET]          中国 上海   chinamobileltd.com  移动
                                            124.05 ms / 123.98 ms / 128.56 ms
9   111.24.4.106    AS9808   [CMNET]          中国 上海   chinamobileltd.com  移动
                                            124.80 ms / 174.96 ms / * ms
10  120.204.37.138  AS24400  [APNIC-AP]       中国 上海 上海  chinamobile.com
                                            125.71 ms / 125.89 ms / 125.69 ms

国内9808，境外走优化线路CMIN2，这就是移动双程极致线路。
```

#### 三网对比

综合的说，就是 `CN2GIA≈CN2CTG>9929≈CMIN2>CN2GT>4837≈163≈CMI`

三网顶级优化

[![image](attachments/c7eab9438008cf0ae75c4f93d4292fef62153ad1_2_690x386.png)](https://linux.do/uploads/default/original/4X/c/7/e/c7eab9438008cf0ae75c4f93d4292fef62153ad1.png "image")

三网主干网

[![image](attachments/a4020d15b461bf979f7a7b3492d698fe1397c66b_2_690x389.jpeg)](https://linux.do/uploads/default/original/4X/a/4/0/a4020d15b461bf979f7a7b3492d698fe1397c66b.jpeg "image")

电信用户：CN2GIA≈CN2CTG>CN2GT>163

联通用户：9929>4837

移动用户：CMIN2>CMI

这是个比较总体的评价，具体到个别商家就又不一样了，极端点的例子，比如10G口4837和20Mbps CN2GIA，你用起来当然是CMI更爽，再比如1000个人挤的100Mbps CN2GIA，和你独享的50Mbps4837，毫无疑问4837更胜一筹，所以不要看到谁谁谁卖的CN2，就是碾压其他的163商家…

奇妙的问题：联通用户是走CN2GIA还是9929好？

一般来说，联通走电信的网络会被跨网qos(就是运营商会qos来自不同的运营商的流量)，所以还是走9929好点。跨网qos最典型的例子就是电信走移动CMI经常被q成10Mbps不到，而移动用户就可以跑到几百Mbps。

#### 暴论环节(纯属个人暴论)

多天使用下来，感觉移动最佳的路线还是CN2GIA，CMIN2的国内段晚高峰还是太拥挤了，虽然电信会qos移动用户，但是CN2还是CN2，走起来体验比CMIN2好多了。至于联通的9929，整体容量口子太小了，和CN2GIA不是一个量级，尤其是亚太，9929口子小的可怜，真不如走CN2GIA了，不过联通用户其实4837表现也不错，不必追求精品网，移动用户也是，lumen还是很快乐的，电信就只能捏着鼻子玩CN2GIA了，不然163真的卡死。

> 就是一个体验而已，因人而异，理性看待

### 4.专线是什么？

> 你可以把专线看作是一台入口在国内，出口在国外的机器，流量因为不走公网，所以可以避免拥塞和审查

#### IPLC与IEPL

**IPLC（International Private Leased Circuit）** ，IPLC是基于传统TDM（时分复用）技术的国际专用租用电路，是一种点对点的物理专线连接服务。它在两个地理位置之间提供固定带宽的独享传输通道，不经过公共互联网。

真正的物理层专用电路，一根点到点的物理专线，延迟固定且极低，零丢包（理论上），带宽保证100%，不受公网拥塞影响。如此优秀的特点，当然是用高昂的价格换的，而且购买需要有一定资质，这也导致了个人用户几乎不可能直接买到IPLC，只能通过下游分销的方式购买。

**IEPL（International Ethernet Private Line）**,IEPL基于分组交换技术的国际以太网专线服务，通过MPLS、VPLS等技术在运营商网络中建立虚拟专用通道，提供端到端的二层或三层专线连接。

和IPLC不同，IEPL并不能做到物理隔离，而是在共享的物理网络上建立逻辑隔离，延迟低但略高于IPLC，近零丢包（有QoS保证），带宽保证，不受公网拥塞影响。同样的价格比IPLC便宜但仍然价格高昂，而且同样需要资质，个人用户不可直接从上游购买到，只能通过分销下游购买。

> 对于个人用户和MJJ而言，IPLC和IEPL最大的好处不是稳定性也不是带宽保证，而是不过墙。IPLC和IEPL面向的都是对网络质量有着最高要求的政企用户，流量根本不会走公网，自然也不会经GFW审查，拥有更低的延时和更快的速度。

专线流量图

```rust
你的流量->专线入口->(跨境)->专线出口->落地
```

IEPL/IPLC都是通过入口和出口命名的，比如深圳入香港出的IPLC就叫深港IPLC；而入口又有电信/移动/联通的区别(跨网qos警告，电信用移动入口可能会卡的不如公网)，所以又叫深港电信IPLC；有些入口是电信联通多线的，就叫BGP入口，所以称为深港BGP专线，以此类推。又会有广州入香港出的广港BGP专线，厦门BGP入香港出的厦港BGP，上海入日本出的沪日IPLC，上海入美国出的沪美专线等，这些都是很常见的专线类型。一般而言，IPLC价格高于IEPL，延时和速度也优于IEPL。

#### IX与前置

传统意义上的IX = Internet Exchange（互联网交换中心），是一个一个中立的网络交换平台，允许不同ISP、CDN、云服务商在此互联，通过二层交换直接交换流量，避免经过上游Transit，降低成本。

著名的IXP例子：

- **HKIX** （香港互联网交换中心）
- **JPIX/JPNAP** （日本）
- **SGIX** （新加坡）

而我们MJJ特指的一般是通过IX接入的云专线"或"上云专线"，其实就是没有公网ip的专线，前面提到的专线什么深港电信专线就是电信公网ip入口，而IX专线的ip是IX交换中心的内网IP，只有特定的厂商的服务器可以接入，比如腾讯云/阿里云/火山云，当你使用这些服务器的时候，这些服务器就可以直接连通IX专线的路由，使得这个服务器成为前置，而你的前置+IX就类似于一条IEPL了，实现准专线级别连接。

核心特征：

```rust
没有公网入口 + 只有IX内网IP + 只与大厂交换路由 + 用户自备前置
```

IX的优劣也很明显：

- 没有公网ip，自然也不用担心被通报，被邻居打扰(很多人的专线是NAT共享ip入口，邻居作恶会连累自己)，当然，这也是厂商的决策：风险转嫁给用户。
- 价格极具竞争力：同样的流量，比传统IEPL/IPLC便宜几倍以上
- 可以解决跨网QoS问题：你是前置可以定制，你可以选择电信入口也可以联通入口也可以BGP入口，就连入口也能定制，IX在深圳我前置可以在深圳也可以在广州也可以在上海，只要能连通IX，无所谓地点(一般而言还是越近越好)
- 延迟高于传统专线：你到前置的路由+出口路由很可能延时要翻倍了，如果前置比较劣质，甚至不如公网传输，当然，最大的好处还是不过墙。
- 前置的不稳定性：这个也成了IX玩法最大的问题，腾讯轻量200Mbps很容易被qos到10Mbps，优质前置入广州BGP/火山等价格极其高昂，甚至压过IEPL和IPLC。

前置流量图

```rust
你的流量->前置->IX入口->(跨境)->IX出口->落地
```

> 推荐目前是主玩IX专线了，因为IEPL和IPLC通报真的太严重了，稳定来看还是IX，就算你是独立ip的专线也免不了要被扫段的风险，认识好多有人被扫段整个段打死了。你自己的前置根本不会被打，因为没人知道你的前置ip是啥。

**记住：专线从来都是一分钱一分货**

#### 精品网络机器

这类机器非常特别，它们是与运营商的优质网络（如9929、CN2 GIA）建立直接BGP互联，通过这个互联关系，让流量走优质路由，基本上就是CN2GIA/9929回程，比如上海9929出口机器和JP的softbank连接，就可以双程9929，达到近乎专线的效果，立刻就让垃圾线路机器变成精品网机器，9929拉韩国KT也是拉出沪韩专线的效果，比较遗憾的是，这类商家非常稀少，而且这个玩法需要对网络极其熟悉，有一定的技术门槛，所以一直没有得到大规模的扩展。

> 这类机器一般都是北京或者上海入口的，比如我正在用的上海利群9929机器，体验还是不错的，测评有空一块发。

不必太过迷信专线，有很多人无脑认为专线就是暴打公网。无论是IEPL还是IPLC还是前置+IX的组合，他能帮你节省的只是跨境的那一段，这一段往往只占几ms，如果你的数据包到前置或者专线入口已经被qos甚至丢包，就会导致专线体验也不怎么样。

> 还有，到底谁在拿专线转发http和TLS祸害苍生…

### 5.国际互联是什么？

**国际互联（International Interconnection）** 是指不同国家/地区的网络运营商之间建立的网络连接关系，使得跨境数据流量能够在全球范围内传输和交换。

**互联协议**

- Peering（对等互联）：平等地位的运营商免费交换流量
- Transit（传输服务）：小运营商付费向大运营商购买国际出口

国际互联的质量直接决定了：

- **跨境访问速度** ：出口带宽是否充足
- **延迟高低** ：互联点的物理距离和路由优化
- **稳定性** ：是否容易在晚高峰拥堵

> 大白话就是 不同AS网络之间数据传输的能力，MJJ统称为国际互联,国际互联好就是这个机器到其他网络非常流畅延时低速度快不丢包，比如HK->美，HK->欧如何，不要以为只有国内讲究优化线路，国外也需要关注的。

一般而言，接入了同一个上游或者IX交换中心的互联起来速度一般很不错，举个例子

**夏威夷家宽hawaii互联案例**

夏威夷家宽肯定不能直连，我们就只能选择中转过去，中转出发地一般就是US/JP/HK。我们先查看目的ip的BGP路由

[![iamge](attachments/9825a6bd282755abc477b50b267b220459291422_2_239x499.png)](https://linux.do/uploads/default/original/4X/9/8/2/9825a6bd282755abc477b50b267b220459291422.png "iamge")

可以看到Hawaiian的直接上游就是Tier1的Cogent和Lumen，那么只要寻找US/HK/JP的接入了Lumen/Cogent的机器就能达到不错的互联效果。

找个HK接入了lumen的机器

```rust
traceroute to 72.253.x.x (72.253.x.x), 30 hops max, 60 byte packets
 1  172.16.0.1 (172.16.0.1) [*]  0.600 ms  3.478 ms  3.411 ms
 2  10.10.91.1 (10.10.91.1) [*]  3.362 ms  3.312 ms  3.265 ms
 3  10.10.40.129 (10.10.40.129) [*]  3.150 ms  3.111 ms  3.055 ms
 4  10.198.10.1 (10.198.10.1) [*]  4.113 ms  4.247 ms  4.541 ms
 5  10.198.1.1 (10.198.1.1) [*]  4.145 ms  4.170 ms  4.131 ms
 6  10.51.0.0 (10.51.0.0) [*]  4.546 ms  2.723 ms  3.662 ms
 7  10.26.1.160 (10.26.1.160) [*]  3.600 ms  3.563 ms  3.536 ms
 8  8.244.7.177 (8.244.7.177) [AS3356]  4.620 ms  4.570 ms  4.538 ms
 9  ae1.3501.edge1.Honolulu1.net.lumen.tech (4.69.206.150) [AS3356]  127.600 ms  127.536 ms  127.486 ms
10  4.79.8.26 (4.79.8.26) [AS3356]  125.662 ms  125.658 ms  125.633 ms
```

可以看到第8跳已经从内网进入了AS3356(lumen)，此时121ms左右已经来到了夏威夷

再找个没接lumen的，比如这个就是绕路cogent的

[![iamge](attachments/b35ed816e5825eeb9cbc1221bc0b0920f145386c.png)](https://linux.do/uploads/default/original/4X/b/3/5/b35ed816e5825eeb9cbc1221bc0b0920f145386c.png "iamge")

```rust
traceroute to 72.253.x.x (72.253.x.x), 30 hops max, 60 byte packets
 1  185.241.40.1 (185.241.40.1) [AS63150]  0.536 ms  0.660 ms  0.615 ms
 2  10.255.93.6 (10.255.93.6) [*]  0.297 ms  0.351 ms  0.314 ms
 3  10.35.88.0 (10.35.88.0) [*]  4.047 ms  4.052 ms  4.015 ms
 4  * * *
 5  be5614.rcr51.hkg01.atlas.cogentco.com (154.24.27.49) [*]  1.795 ms  1.635 ms  1.875 ms
 6  be2414.ccr21.hkg02.atlas.cogentco.com (154.54.88.49) [AS174]  1.765 ms  1.543 ms  1.492 ms
 7  be4558.ccr41.lax04.atlas.cogentco.com (154.54.94.114) [AS174]  148.205 ms  154.932 ms be2327.ccr41.lax01.atlas.cogentco.com (154.54.0.5) [AS174]  154.758 ms
 8  be3360.ccr42.lax01.atlas.cogentco.com (154.54.25.149) [AS174]  155.384 ms  155.212 ms  155.398 ms
 9  be2197.rcr21.b020604-0.lax01.atlas.cogentco.com (154.54.0.166) [AS174]  146.467 ms be2199.rcr21.b020604-0.lax01.atlas.cogentco.com (154.54.2.174) [AS174]  148.846 ms 38.142.79.194 (38.142.79.194) [AS174]  202.853 ms
10  38.142.79.194 (38.142.79.194) [AS174]  196.908 ms  203.079 ms 72.253.143.130 (72.253.143.130) [AS36149]  197.347 ms
11  * 10.64.4.1 (10.64.4.1) [*]  201.343 ms  201.624 ms
12  72.253.x.x (72.253.x.x) [AS36149]  185.861 ms  185.789 ms  185.761 ms
```

这个时候HK到夏威夷绕洛杉矶延时暴增到185ms，你可能会很奇怪：明明hawaii也接入了cogent，为什么不是直的？因为这个机器并不是直接接入cogent的，而是中转了好几手，而且HK到夏威夷cogent也不一定有直接路由，所以最后只能绕路洛杉矶。这个事情说明BGP上看到的判定也不一定准，大部分时候是准的，但还是要具体实践。

> 大部分情况下，直接接入的Tier越多互联越强，路由越直，但是直接接入费用高昂，大部分商家都是找下游转接比如CTC/GSL等。

常见Tier介绍：

- Lumen (AS3356)：很多时候又被称为level3，互联广泛，亚太到美国、欧洲都有直连，移动用户快乐机，很多中小IDC选择lumen作为上游，性价比高。
- RETN (AS9002)：欧洲/俄罗斯互联优秀，拥有跨欧亚陆路光缆，接入了RETN的机器访问欧洲地区的服务速度比较优异，香港到欧洲走RETN陆路比绕美国快50-100ms。
- NTT (AS2914)：日本电信巨头，全球顶级Tier1之一，在亚太地区网络质量极其优秀，日本本土霸主地位。到日本的业务首选NTT，亚太内部互联(HK-SG-JP)也非常快。缺点是价格昂贵，直接接入NTT的成本很高，但质量确实好。
- Softbank (AS17676)：日本三大运营商之一，虽然不是Tier1但在日本本土和亚太地区表现优秀。很多日本机器接入Softbank，与国内9929/CN2有良好互联，是精品网络机器常用的组合(比如上海9929出口机器+JP Softbank可以双程9929)，而且softbank往往都是家宽，ip质量也不错。
- Cogent (AS174)：全球最便宜的Tier1，以激进的路由策略和低价著称。优点是便宜、覆盖广，美国内部网络不错。
- GTT (AS3257)：欧洲起家的Tier1，在欧洲网络质量优秀，全球覆盖也不错。很多欧洲机房的首选上游，价格比NTT便宜，比Cogent贵，属于中端定位。适合有欧洲业务需求的用户。
- Telia/Arelion (AS1299)：北欧起家的老牌Tier1(2022年Telia Carrier改名为Arelion)，全球化运营，网络稳定性好。在欧洲和北美都有强势表现，亚太覆盖也在扩展。整体质量稳定，属于可靠的选择。
- Hurricane Electric/HE (AS6939)：大型Tier2运营商（自称IPv6 Tier1），以免费peering政策著称(与任何人都愿意peer)，因此成为很多小IDC的首选上游。优点是便宜、IPv6支持好、接入方便；缺点是因为太开放，部分地区可能被限制(比如某些地区的Netflix会屏蔽HE)。
- PCCW (AS3491)：香港电讯盈科，香港本土霸主，在亚太地区互联优秀。香港机房接入PCCW通常意味着到大陆、东南亚、日韩的速度都不错。与国内三大运营商都有良好互联，是香港优质线路的代表。缺点是到欧美可能需要转接其他Tier1。
- GSL Networks (AS137409/AS7578)：Global Secure Layer，优质的Tier2运营商，很多高端IDC选择GSL作为上游(比如DMIT)。GSL接入了多个Tier1(Zayo/Cogent/NTT等)，路由优化好，价格比直接接入Tier1便宜，是性价比之选。在洛杉矶、香港、新加坡等地都有POP点。
- 还有IIJ/KDDI/CTC/等等…就不一一介绍了

补充：

IX交换中心(Internet Exchange)：

- HKIX (香港互联网交换中心)：亚太最重要的IX之一，大量运营商在此互联。接入HKIX的机器在亚太内部互联通常很优秀，到大陆、东南亚、日韩速度都不错。很多IX专线(上云专线)就是利用HKIX来实现准专线级别连接。
- JPIX/JPNAP (日本)：日本主要的IX，在东京有多个节点。接入日本IX的机器在日本本土和亚太互联表现优秀，很多日本VPS都会接入JPIX。
- SGIX (新加坡)：新加坡互联网交换中心，东南亚枢纽。新加坡作为东南亚互联网中心，SGIX的作用非常重要，接入SGIX意味着到东南亚各国速度都不错。
- EQUINIX：全球最大的IX运营商，在全球主要城市都有交换中心(如香港、新加坡、东京、洛杉矶、法兰克福等)。很多Tier1和大型运营商都在Equinix的机房互联，接入Equinix IX通常意味着优质的互联环境。

> 比如TW的互联，往往都是依靠HKIX，接入了HKIX的机器港台延时极低，没接的往往会绕路。而且教育网走HKIX格外快乐，也是个快乐机。

### 6.常见测试工具

**路由追踪工具 traceroute / mtr**

最基础也是最重要的路由追踪工具，可以查看数据包经过的每一跳路由节点。

```rust
traceroute ip //追踪路由（Linux默认使用UDP，加-I使用ICMP）
traceroute -I ip //使用ICMP协议追踪
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 60 byte packets
 1  * * *
 2  irb-25.er01.hkg.DMIT.com (193.41.248.84)  0.334 ms  0.335 ms  0.273 ms
 3  AS906.Backbone.DMIT.com (193.41.248.29)  0.722 ms  0.791 ms  0.790 ms
 4  192.178.111.191 (192.178.111.191)  2.612 ms * 192.178.111.177 (192.178.111.177)  0.313 ms
 5  dns.google (8.8.8.8)  0.598 ms 74.125.253.93 (74.125.253.93)  0.661 ms dns.google (8.8.8.8)  0.248 ms
 
traceroute -A ip //显示过程中的ASN
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 60 byte packets
 1  Anycast.Gateway.DMIT.com (193.41.250.250) [AS906/AS54574]  0.088 ms  0.051 ms  0.050 ms
 2  irb-25.er01.hkg.DMIT.com (193.41.248.84) [AS906/AS54574]  0.461 ms  0.431 ms  0.479 ms
 3  AS906.Backbone.DMIT.com (193.41.248.29) [AS906/AS54574]  0.686 ms  0.676 ms AS906.Backbone.DMIT.com (193.41.248.31) [AS906/AS54574]  0.271 ms
 4  192.178.111.177 (192.178.111.177) [AS15169]  0.276 ms 142.251.232.85 (142.251.232.85) [AS15169]  2.354 ms *
 5  dns.google (8.8.8.8) [AS15169]  0.229 ms 72.14.232.155 (72.14.232.155) [AS15169]  0.690 ms dns.google (8.8.8.8) [AS15169]  0.223 ms

很多时候目标主机可能会限制ICMP，所以我们可以改用TCP追踪
traceroute -T ip

也可以用
# mtr报告模式指定目标IP
mtr -r -c 100 <目标IP>
root@hkgt1:~# mtr -r -c 100 45.127.x.x
Start: 2025-11-29T04:42:14+0000
HOST: hkgt1                       Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- Anycast.Gateway.DMIT.com   0.0%   100    0.2   0.2   0.1   1.6   0.2
  2.|-- irb-25.er01.hkg.DMIT.com   0.0%   100    0.4   0.7   0.3  13.4   1.7
  3.|-- unknown.globalsecurelayer  0.0%   100    0.4   0.4   0.3   0.5   0.0
  4.|-- po2.hk-eqxhk1-bb3.globals  0.0%   100    0.7   0.5   0.4   0.8   0.1
  5.|-- e6.sg3-eqxsg3-cr8.globals  0.0%   100   30.0  30.1  29.8  31.6   0.2
  6.|-- unknown.globalsecurelayer  0.0%   100   30.4  30.2  29.9  32.4   0.4
  7.|-- po7.sg-eqxsg3-cr2.globals  0.0%   100   29.9  29.9  29.8  30.2   0.1
  8.|-- epsilon-telecom.sgix.sg    1.0%   100   31.0  31.9  30.8  42.6   2.2
  9.|-- 180.178.72.74              6.0%   100   30.5  30.5  30.4  31.6   0.1
 10.|-- static.45.127.34.28.orang  0.0%   100   30.7  30.8  30.5  38.4   0.8
```

**最简单便捷的延时测试 ping**

```lua
ping <ip>
ping 45.127.x.x
PING 45.127.x.x (45.127.x.x) 56(84) bytes of data.
64 bytes from 45.127.x.x: icmp_seq=1 ttl=55 time=30.5 ms
.
.
.
--- 45.127.x.x ping statistics ---
12 packets transmitted, 12 received, 0% packet loss, time 11019ms
rtt min/avg/max/mdev = 30.520/30.621/30.729/0.060 ms
```

**一键脚本**

```rust
bash <(curl -Ls Net.Check.Place)
```

[![image](attachments/60f926abf0f82463c634597137ee9808cfa891be_2_416x500.png)](https://linux.do/uploads/default/original/4X/6/0/f/60f926abf0f82463c634597137ee9808cfa891be.png "image")

快速测试网络/BGP/国际互联。

> 接入了lumen，所以是移动快乐机

**不错的查询网站**

[ITDOG](https://www.itdog.cn/) ：快速测试ip到国内大部分地区的ICMP/TCP延时

[BGPtool](https://bgp.tools/) ：快速查询ip对应的BGP和路由情况，上面的图都是来自这个网站

[IPIPNET](https://www.ipip.net/stats/bgp.html) ：查看IP的详细路由和AS信息

**本文难免有遗漏错误，欢迎指出，持续更正。**

**记住三大真理:**

1. 最短的路由,是从你的钱包到IDC的口袋
2. 买VPS就像开盲盒,开出垃圾线路别哭,至少你还有退款——哦等等,你买的是年付不退款。
3. 这个商家说的"优化大带宽",可能只是他们家猫的名字

That’s all, 各位,祝你们永不被Q。 **—— [ICMP不可达喵](https://meowvps.com/blog/route/) (及我那些到不了的数据包)**

## 由 stevessr 发布于 11月 29 日

## 由 YoungYang 发布于 11月 29 日

## 由 marre 发布于 11月 29 日

## 由 hanlinwenyuan 发布于 11月 29 日

## 由 admin10086 发布于 11月 29 日

上次访问